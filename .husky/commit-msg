#!/bin/sh

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ê²½ë¡œ
commit_msg_file=$1

# ì»¤ë°‹ ë©”ì‹œì§€ ì½ê¸°
commit_msg=$(cat "$commit_msg_file")

# í—ˆìš©ë˜ëŠ” prefix ëª©ë¡
allowed_prefixes="feat fix docs style refactor test chore hotfix"

# prefix ê²€ì‚¬
is_valid=false
prefix_found=""
for prefix in $allowed_prefixes; do
  if [[ "$commit_msg" == "$prefix: "* ]]; then
    is_valid=true
    prefix_found=$prefix
    break
  fi
done

# ìœ íš¨í•˜ì§€ ì•Šì€ prefixì¸ ê²½ìš° ì»¤ë°‹ ê±°ë¶€
if ! $is_valid; then
  echo "Error: ì»¤ë°‹ ë©”ì‹œì§€ prefixê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
  echo "í—ˆìš©ë˜ëŠ” prefix: $allowed_prefixes"
  exit 1
fi

# ì´ëª¨ì§€ê°€ ì´ë¯¸ ìžˆëŠ”ì§€ í™•ì¸
if [[ "$commit_msg" =~ ^[[:space:]]*[[:punct:]].*$ ]]; then
  exit 0
fi

# ì´ëª¨ì§€ ë§¤í•‘
case $prefix_found in
  "feat") emoji="âœ¨";;
  "fix") emoji="ðŸ› ï¸";;
  "docs") emoji="ðŸ“";;
  "style") emoji="ðŸŽ¨";;
  "refactor") emoji="â™»ï¸";;
  "test") emoji="â˜‘ï¸";;
  "chore") emoji="âš™ï¸";;
  "hotfix") emoji="ðŸ”¥";;
esac

# ì´ëª¨ì§€ ì¶”ê°€
new_commit_msg="$emoji $commit_msg"
echo "$new_commit_msg" > "$commit_msg_file"
