# ğŸ§¥ SHAREDRESS í¬íŒ… ë§¤ë‰´ì–¼

---

## ğŸ“‘ ëª©ì°¨

### I. ê°œìš”
1. í”„ë¡œì íŠ¸ ê°œìš”  
2. ì‚¬ìš© ë„êµ¬ ë° ê¸°ìˆ  ìŠ¤íƒ  
3. ê°œë°œ í™˜ê²½  
4. ì™¸ë¶€ ì„œë¹„ìŠ¤ ëª©ë¡  
5. Gitignore ì²˜ë¦¬í•œ ë³´ì•ˆ í‚¤ ëª©ë¡

### II. ë¹Œë“œ ë° ë°°í¬
1. í™˜ê²½ ë³€ìˆ˜  
    1.1 frontend/.env.local  
    1.2 backend/.env, application.yml  
2. ë¹Œë“œ ë°©ë²•  
    2.1 í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ  
    2.2 ë°±ì—”ë“œ ë¹Œë“œ  
    2.3 AI ì„œë²„ ë¹Œë“œ  
    2.4 Musinsa í¬ë¡¤ëŸ¬ ì‹¤í–‰ ë°©ë²•  
3. CI/CD (Jenkins) êµ¬ì„±  
    3.1 í”„ë¡ íŠ¸ì—”ë“œ Jenkinsfile  
    3.2 ë°±ì—”ë“œ Jenkinsfile  
4. Docker í™˜ê²½ êµ¬ì„±  
    4.1 ë°±ì—”ë“œ Dockerfile  
5. Nginx êµ¬ì„±  
    5.1 nginx.conf  

### III. DB êµ¬ì„±
1. DB ë¤í”„ íŒŒì¼ ì ìš© ë°©ë²•  

### IV. ì‹œì—° ì‹œë‚˜ë¦¬ì˜¤
1. ì „ì²´ ì‚¬ìš©ì íë¦„  
2. ì£¼ìš” í™”ë©´ë³„ ê¸°ëŠ¥ ì„¤ëª…  

---

## I. ê°œìš”

### 1. í”„ë¡œì íŠ¸ ê°œìš”
> **"ë‚˜ë§Œì˜ ë””ì§€í„¸ ì˜·ì¥ì„ ì¹œêµ¬ì™€ í•¨ê»˜, íŒ¨ì…˜ ê³µìœ  í”Œë«í¼"**

ì‚¬ìš©ì ê°œì¸ì˜ ì˜·ì„ ì†ì‰½ê²Œ ë“±ë¡í•˜ê³ , ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ íŒ¨ì…˜ì„ ê³µìœ í•˜ë©° ì†Œí†µí•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.  
AI ê¸°ë°˜ì˜ ìë™ ì˜· ë“±ë¡ ë° ì½”ë”” ì¶”ì²œ ê¸°ëŠ¥ì„ í†µí•´ ì¼ìƒ ì† íŒ¨ì…˜ ê³ ë¯¼ì„ ëœì–´ì£¼ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

### 2. ì‚¬ìš© ë„êµ¬ ë° ê¸°ìˆ  ìŠ¤íƒ

| í•­ëª© | ë„êµ¬ |
|------|------|
| **FE** | React, TypeScript, Zustand, Tanstack, Tailwind CSS |
| **BE** | Spring Boot, JPA, QueryDSL, MariaDB, Node.js, Google OAuth, JWT |
| **Infra** | AWS EC2, S3, SQS, GTM, Sentry, FCM |
| **AI** | Python, CLIP, rembg, OpenCV, UNO, HuggingFace |

### 3. ê°œë°œ í™˜ê²½

- **VS Code**: 1.98.2  
- **IntelliJ IDEA**: 2024.3  
- **JVM**: OpenJDK 17  
- **DB**: MariaDB  
- **ì„œë²„**: AWS EC2 (Amazon Linux 2023)

### 4. ì™¸ë¶€ ì„œë¹„ìŠ¤

- Google OAuth  
- AWS S3 / SQS  
- Firebase Cloud Messaging  
- Playwright (ë¬´ì‹ ì‚¬ ì›¹ ìŠ¤í¬ë˜í•‘)  
- ngrok (AI ì„œë²„ ê°œë°œìš©)  
- HuggingFace CLIP ëª¨ë¸  
- rembg (ë°°ê²½ ì œê±°)  
- UNO (ì˜· ì˜ì—­ ì¶”ì¶œ)  
- Sentry  
- Google Tag Manager  

### 5. Gitignore ì²˜ë¦¬í•œ ë³´ì•ˆ í‚¤ ëª©ë¡

- `frontend/.env.local`  
- `backend/src/main/resources/.env`  
- `backend/src/main/resources/application.yml`



---



## **I. ê°œìš”**

### **1\. í”„ë¡œì íŠ¸ ê°œìš”**

**ë‚˜ë§Œì˜ ë””ì§€í„¸ ì˜·ì¥ì„ ì¹œêµ¬ì™€ í•¨ê»˜, íŒ¨ì…˜ ê³µìœ  í”Œë«í¼**

ì‚¬ìš©ì ê°œì¸ì˜ ì˜·ì„ ì†ì‰½ê²Œ ë“±ë¡í•˜ê³ , ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ íŒ¨ì…˜ì„ ê³µìœ í•˜ë©° ì†Œí†µí•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.  
AI ê¸°ìˆ ì„ ê¸°ë°˜ìœ¼ë¡œ ì˜· ë“±ë¡ì„ ìë™í™”í•˜ê³ , ì½”ë”” ì¶”ì²œì„ í†µí•´ ì¼ìƒ ì† íŒ¨ì…˜ ê³ ë¯¼ì„ ëœì–´ì£¼ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

### **2\. ì‚¬ìš© ë„êµ¬ ë° ê¸°ìˆ  ìŠ¤íƒ**

| í•­ëª© | ë„êµ¬ |
| :---: | ----- |
| FE | React, TypeScript,  Zustand, Tanstack, Tailwind CSS |
| BE | Spring Boot, JPA, QueryDSL, MariaDB, Nodejs, Google OAuth, JWT |
| Infra | EC2, S3, SQS, GTM, Sentry, FCM |
| AI | Python, CLIP, rembg, OpenCV, UNO, HuggingFace |

### 

### **3\. ê°œë°œí™˜ê²½**

* VS Code: 1.98.2  
* IntelliJ IDEA: 2024.3  
* JVM: OpenJDK 17  
* DB: MariaDB   
* SERVER : AWS EC2 Amazon linux 2023

### **4\. ì™¸ë¶€ ì„œë¹„ìŠ¤**

* Google OAuth  
* AWS S3  
* AWS SQS  
* Firebase Cloud Messaging  
* Playwright (ë¬´ì‹ ì‚¬ ë¡œê·¸ì¸ ì›¹ ìŠ¤í¬ë˜í•‘)  
* ngrok (AI ì„œë²„ ê°œë°œìš©)  
* HuggingFace CLIP ëª¨ë¸ (ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜)  
* rembg (ë°°ê²½ ì œê±°)  
* UNO (ì˜· ì˜ì—­ ì¶”ì¶œ)  
* Sentry  
* Google Tag Manager

### **5\. Gitignore ì²˜ë¦¬í•œ ë³´ì•ˆ í‚¤**

* .env (frontend/.env.local)   
* .env (backend/src/main/resources)

---

## **II. ë¹Œë“œ**

### **1\. í™˜ê²½ ë³€ìˆ˜ í˜•íƒœ**

\[FE\] .env.local
```
VITE_GOOGLE_CLIENT_ID='99996905904-t5nvi6ivm3naggg8uejtmtigf48au497.apps.googleusercontent.com'
VITE_API_URL='https://www.sharedress.co.kr'
VITE_FIREBASE_API_KEY='AIzaSyAohU9TYUEdEKjkItxUBoK9OHiiB4XyMYc'
```

\[BE\] application.yml
```
spring:
   application:
       name: backend                 # â† ì•± ì´ë¦„

   config:
       import: optional:file:.env[.properties]

   datasource:
       url: ${DB_URL}
       username: ${DB_USER}
       password: ${DB_PASSWORD}
       driver-class-name: com.mysql.cj.jdbc.Driver

   jpa:
       hibernate:
           ddl-auto: update
       show-sql: false
       properties:
           hibernate:
               format_sql: true
               jdbc.time_zone: Asia/Seoul
       open-in-view: false
  
   datasource.hikari:
       connection-init-sql: SET NAMES utf8mb4

   jackson:
       time-zone: Asia/Seoul

   servlet:
       multipart:
           max-file-size: 10MB
           max-request-size: 20MB

---
management:
   endpoints:
       web:
           exposure:
               include: health,info

---
jwt:
   secret: ${JWT_SECRET}

---
logging:
   level:
       root: INFO
       com.ssafy.sharedress.config: DEBUG
       com.ssafy.sharedress.adapter: INFO
       com.ssafy.sharedress.application: INFO
       org.springframework.web: INFO

---
cloud:
   aws:
       region: ap-northeast-2
       credentials:
           access-key: ${AWS_ACCESS_KEY}
           secret-key: ${AWS_SECRET_KEY}
       sqs:
           queues:
               ai-processing:
                   url: https://sqs.ap-northeast-2.amazonaws.com/273354621375/ai-processing.fifo
                   queue-name: ai-processing.fifo
               ai-photo:
                   url: https://sqs.ap-northeast-2.amazonaws.com/273354621375/ai-photo.fifo
                   queue-name: ai-photo.fifo

       s3:
           bucket: ai-processing-output
           path:
               profile: profile
               coordination: coordination
               photo: photo
       stack:
           auto: false

---
firebase:
   type: ${FIREBASE_TYPE}
   project_id: ${FIREBASE_PROJECT_ID}
   private_key_id: ${FIREBASE_PRIVATE_KEY_ID}
   private_key: ${FIREBASE_PRIVATE_KEY}
   client_email: ${FIREBASE_CLIENT_EMAIL}
   client_id: ${FIREBASE_CLIENT_ID}
   auth_uri: ${FIREBASE_AUTH_URI}
   token_uri: ${FIREBASE_TOKEN_URI}
   auth_provider_x509_cert_url: ${FIREBASE_AUTH_PROVIDER_X509_CERT_URL}
   client_x509_cert_url: ${FIREBASE_CLIENT_X509_CERT_URL}
   universe_domain: ${FIREBASE_UNIVERSE_DOMAIN}
```

\[BE\] .env
```
# Maria DB
DB_URL=jdbc:mysql://stg-yswa-kr-practice-db-master.mariadb.database.azure.com:3306/S12P31A705?serverTimezone=UTC&useUnicode=true&characterEncoding=utf8
DB_USER=S12P31A705@stg-yswa-kr-practice-db-master
DB_PASSWORD=H1hN9aZkMH

# Google OAuth
GOOGLE_CLIENT_ID=99996905904-t5nvi6ivm3naggg8uejtmtigf48au497.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=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
GOOGLE_REDIRECT_URI=http://localhost:3000/oauth/google/callback

# JWT
JWT_SECRET=6413de49a2d75afc15c313f0ad688812b57fbae19f4877911a280ebd6fb7adaad2725416d3792b0a3f9e2e82b56d46b1dbba777ad9684bc47f523cfa0ba7eae75b507789c03a06f191310f25615c0fe382ee108d430966547f85f7da83e7e110c64674495bbef36c91059b0ecd6c53770b1b091a99acc1dd3721cd7157092afcd73c6cbfa7bc45e1923cc1a341578cd77814c60c27e2170598e88df648d97bd9b3094db8b96df877cb4220cfca1d3d73038061bab6b4d7f3c099ced97da590efa2d458b0758e7c24803a3ab11ce07dea19629b12a557733eb8abcf55807e01db24e6f4b0aa78b25d3813277d1faeb3fb867e5aa425343af883d933d351bb7440

# AWS
AWS_ACCESS_KEY=AKIAT7JJUQG7YSHUEXWM
AWS_SECRET_KEY=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

# Firebase
FIREBASE_TYPE=service_account
FIREBASE_PROJECT_ID=sharedress-ef653
FIREBASE_PRIVATE_KEY_ID=e46ded48f3cadc6352ccf5fa944c056de1278343
FIREBASE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC1BTGJoMUHU7Bm\nTbdYJBZa24GI6zhLlYa7wzOZT1urh/nIXh3U5WvalYaExYgSXIPYJTSzICe56N3E\nHFGRFKMsi/Ow1ZVWbnP2nsnkChnfMYG3Te7Rjj9YmHAPi03aMwk1qCKk8/58hKFw\nrny9jl01tWnggAeUJsG9ncGar4XeoX3IOsohz209yScj7fTPqNR8gG/kUCad56zC\nSrc4CLeuJN3QztFtfC67kMQ5KVAqS5ZC4p3LvVd/SSCsw33sG10SIzKU4UQWQsqT\nhwVtKCBb0tC5fOI4zwzssOHt5YxtTVTUA2+P7daBzclSx96oPnJoQmQCqH0OzL6p\ncmpKzeE5AgMBAAECggEAByS8kvgRdmvOzQa5msSXzj+V0cuohdERh1TZcy4eybrc\nuFPAfR+NnUtjytcJuuHEQTIcrYnyD2PZZo0QifdkxhQCyqJvGYFT2bJj+LgOU9C+\nE/gDGelxZgNj/rUKXjc/4IpxTY2kaBEK1unH2eolkwJE+ptK0UWjRSKV2o8dKw8m\nuoa4yFOG506lGBWZ8RNvWwbQaZEU7e/8nDcqJkG+3En1ltoRaEmP8qpK+ibT7ZiC\n0Y3M/tOMR6GjboACuiWDPKY/8bF9+crxPpBPCyTI5VGcwhosZEVkNDZBno8GWY1h\nV0PmuoTPknq9KLdwnQj888HVJFtf8IwdEgbKbsrfRQKBgQD6YcS+LbqjRkisMk1d\nTi81HnQKNfA6jcOPGuevkvGHj+el5lraZWzgh0Lt3tw3II+dRTTWwqUz130qLeoj\nhj25Tm3i2PwvKmIMDwDBV9HEiLn6peQm242GladiVu2oGVkF4dNtewGBUJOCi49a\nQEcJn928IA8YspINVDgE2OtNZQKBgQC5FQBZAi5BPERU9d1EXZSaTFaLAqLiyAOY\nM7hq9Zm80mjiA/m+B8pjfQJr4AZEIPoec0k0Lb08W/UiaAnoU62kvQDaPo+3FIT0\n6MqBaMYiNH9aM0dRO6wI/W9SOTDEkiTFqgc6FyV81PFcPNR1zuzxYfC0b/9kODGG\nYmHSMkghRQKBgQD1ZW1Wl6sc632+h26bzE0oWriQaV0Rhm/sigoZYoOmwbvgNW1G\nL7IOPYOzb4GV5ivbkEDBW/ReYw0hke6w8pj8TYoVk2VXNMrz1qB+3nuRjA/7QSvj\nibuj9HkhQOGcp3tA8Jwv6ScIftiUUgQmCGmXXUANab5iDmJm/ewJlDDKoQKBgAyX\ntDVaI6GGozOQouRi5Zh19zFwFXsOlsgFRNfqK/Kf8kjmcliOmSOZvs9uJ579C2eE\n+ocVUZnIu+4CXCI1h0v9HBC9TvPq7nznVdfmNAzhu4R8lq6dO8BE1g0nHP1S4DOe\ntO0r4/4RUvauoNn/ITnvKvxr3lmIRT5adUNi7mttAoGABxC5rfoSRoYNLtV7f39q\nPKhSOGja+oqLH/K6RAk0ZrWrPQBcJxs8jDDlXqS/lo3Fq6jyiSeYTS4kXKytY0T4\nR/vheIpjEiDdF+E6E3iZbilN1ekfZSZKZ2vNSZGRINthVSM5R6zeaqOCxU8MPfq2\nfpMLV4u+vRWUpkg/hXvlPbA=\n-----END PRIVATE KEY-----\n
FIREBASE_CLIENT_EMAIL=firebase-adminsdk-fbsvc@sharedress-ef653.iam.gserviceaccount.com
FIREBASE_CLIENT_ID=111310147761132415249
FIREBASE_AUTH_URI=https://accounts.google.com/o/oauth2/auth
FIREBASE_TOKEN_URI=https://oauth2.googleapis.com/token
FIREBASE_AUTH_PROVIDER_X509_CERT_URL=https://www.googleapis.com/oauth2/v1/certs
FIREBASE_CLIENT_X509_CERT_URL=https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40sharedress-ef653.iam.gserviceaccount.com
FIREBASE_UNIVERSE_DOMAIN=googleapis.com

```

### 

\[AI\] .env
```
AWS_ACCESS_KEY=AKIAT7JJUQG7YSHUEXWM
AWS_SECRET_KEY=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
AWS_REGION=ap-northeast-2
SQS_QUEUE_URL=https://sqs.ap-northeast-2.amazonaws.com/273354621375/ai-processing.fifo
S3_BUCKET=ai-processing-output
DB_HOST=stg-yswa-kr-practice-db-master.mariadb.database.azure.com
DB_NAME=S12P31A705
DB_USER=S12P31A705@stg-yswa-kr-practice-db-master
DB_PASSWORD=H1hN9aZkMH
DB_PORT=3306
OPENAI_API_KEY=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
COMPLETION_API_URL=https://www.sharedress.co.kr/api/clothes/ai-complete
WORKER_CONCURRENCY=2

```

\[AI\] requirements.txt
```
aiohttp==3.9.5
aiosignal==1.3.2
annotated-types==0.7.0
anyio==4.9.0
attrs==25.3.0
beautifulsoup4==4.12.3
boto3==1.34.100
botocore==1.34.100
certifi==2025.4.26
charset-normalizer==3.4.2
click==8.2.0
colorama==0.4.6
coloredlogs==15.0.1
contourpy==1.3.2
cycler==0.12.1
distro==1.9.0
dnspython==2.7.0
email_validator==2.2.0
fastapi==0.111.0
fastapi-cli==0.0.7
filelock==3.18.0
flatbuffers==25.2.10
fonttools==4.58.0
frozenlist==1.6.0
fsspec==2025.3.2
ftfy==6.3.1
greenlet==3.2.2
h11==0.16.0
httpcore==1.0.9
httptools==0.6.4
httpx==0.26.0
huggingface-hub==0.31.1
humanfriendly==10.0
idna==3.10
imageio==2.37.0
Jinja2==3.1.6
jiter==0.9.0
jmespath==1.0.1
joblib==1.5.0
schema==4.23.0
schema-specifications==2025.4.1
kiwisolver==1.4.8
lazy_loader==0.4
llvmlite==0.44.0
lxml==5.2.1
markdown-it-py==3.0.0
MarkupSafe==3.0.2
matplotlib==3.10.3
mdurl==0.1.2
mpmath==1.3.0
multidict==6.4.3
networkx==3.4.2
ngrok==1.4.0
numba==0.61.2
numpy==2.2.5
onnxruntime-gpu==1.19.0
open_clip_torch==2.32.0
openai==1.78.0
opencv-python==4.10.0.82
opencv-python-headless==4.11.0.86
or==3.10.18
packaging==25.0
pandas==2.2.3
pillow==11.2.1
platformdirs==4.3.8
pooch==1.8.2
propcache==0.3.1
protobuf==6.30.2
psutil==7.0.0
py-cpuinfo==9.0.0
pydantic==2.11.4
pydantic_core==2.33.2
Pygments==2.19.1
PyMatting==1.1.13
PyMySQL==1.1.1
pyngrok==7.2.8
pyparsing==3.2.3
pyreadline3==3.5.4
python-dateutil==2.9.0.post0
python-dotenv==1.1.0
python-multipart==0.0.20
pytz==2025.2
PyYAML==6.0.2
referencing==0.36.2
regex==2024.11.6
rembg==2.0.65
requests==2.31.0
rich==14.0.0
rich-toolkit==0.14.5
rpds-py==0.24.0
s3transfer==0.10.4
safetensors==0.5.3
scikit-image==0.25.2
scikit-learn==1.5.0
scipy==1.15.3
seaborn==0.13.2
shellingham==1.5.4
six==1.17.0
sniffio==1.3.1
soupsieve==2.7
SQLAlchemy==2.0.30
starlette==0.37.2
sympy==1.13.1
threadpoolctl==3.6.0
tifffile==2025.5.10
timm==1.0.15
tokenizers==0.21.1
torch==2.5.0+cu121
torchaudio==2.5.0+cu121
torchvision==0.20.0+cu121
tqdm==4.67.1
transformers==4.51.3
typer==0.15.3
typing-inspection==0.4.0
typing_extensions==4.13.2
tzdata==2025.2
u==5.10.0
ultralytics==8.3.131
ultralytics-thop==2.0.14
urllib3==2.4.0
uvicorn==0.29.0
watchfiles==1.0.5
wcwidth==0.2.13
websockets==15.0.1
yarl==1.20.0
pillow-heif==0.10.0

```

### 

### **2\. 2 ë¹Œë“œ ë°©ë²•**

#### FE
```bash
npm install
npm run build 
```

#### BE
```bash
./gradlew clean build
```

AI
```bash
pip install \-r requirements.txt
```

Musinsa-login
```
npm install
node index.js
```

### **2.3 CI/CD (Jenkins) êµ¬ì„±**

\[FE\] Jenkinsfile
```
pipeline {
  agent any

  environment {
    BUILD_TAG = "${BUILD_NUMBER}-fe"
    BLUE_IP   = '172.31.35.103'
    DIST_DIR  = 'frontend/dist'
    SSH_USER  = 'ec2-user'
  }

  tools {                      
    nodejs 'node20'            
  }

  stages {

    stage('Checkout') {
      steps { checkout scm }
    }

    stage('Inject env') {           
      steps {
        configFileProvider([
          configFile(
            fileId: 'fe-env-production',       
            targetLocation: 'frontend/.env.production'
          )
        ]) {
          echo 'âœ…  .env.production ì£¼ì… ì™„ë£Œ'
        }
      }
    }

    stage('Install & Build') {      
      steps {
        dir('frontend') {
          sh '''

            echo "ğŸ”§  Installing deps..."
            npm ci --legacy-peer-deps

            echo "ğŸ“¦  Building..."
            # Vite ëŠ” .env.production ì„ ìë™ìœ¼ë¡œ ì½ì–´ ì¸ë¼ì¸
            npm run build -- --mode production      # â˜… ì¶”ê°€ â·
          '''
        }
      }
    }

    stage('Deploy to Blue') {
      steps {
        sshagent(credentials: ['lb-ssh']) {  
          sh """
            echo 'ğŸš€  Rsync to Blue...'
            rsync -avz --delete -e "ssh -o StrictHostKeyChecking=no" \
                  ${DIST_DIR}/ ec2-user@${BLUE_IP}:/var/www/blue/

            echo 'ğŸ”„  Switch current â†’ blue'
            ssh -o StrictHostKeyChecking=no ${SSH_USER}@${BLUE_IP} '
              sudo mkdir -p /var/www/current &&
              sudo ln -sfn /var/www/blue /var/www/current &&
              sudo chown -R ${SSH_USER}:${SSH_USER} /var/www &&
              sudo nginx -s reload
            '
          """
        }
      }
    }
  }

  post {
    success { echo "âœ…  FE build ${BUILD_TAG} ë°°í¬ ì™„ë£Œ (â†’ Blue)" }
    failure { echo "âŒ  FE build ì‹¤íŒ¨ - ì½˜ì†” ë¡œê·¸ í™•ì¸" }
  }
}

```

\[BE\] Jenkinsfile
```
pipeline {
  agent any
  environment {
    AWS_REGION  = 'ap-northeast-2'
    ACCOUNT_ID  = '273354621375'
    ECR_URI     = "${ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com"
    APP_NAME    = 'spring-app'
    BUILD_TAG   = "${env.BUILD_NUMBER}-green"
    GREEN_IP    = '172.26.11.74'  // Green EC2 IP ì£¼ì†Œ
    LB_IP       = '172.31.35.103'  // Nginx ë¡œë“œë°¸ëŸ°ì„œ IP ì£¼ì†Œ
  }

  stages {
    stage('Checkout') {
      steps {
        checkout scm
      }
    }

    stage('Build JAR') {
      steps {
        dir('backend') {
          sh './gradlew clean bootJar'
        }
      }
    }

    stage('Buildx Push') {
      steps {
        sh '''
          aws ecr get-login-password --region $AWS_REGION |
            docker login --username AWS --password-stdin $ECR_URI

          docker buildx build \
            --platform linux/amd64,linux/arm64 \
            --provenance=false \
            -t $ECR_URI/$APP_NAME:$BUILD_TAG \
            --push backend/.
        '''
      }
    }

    stage('Deploy to Green') {
      steps {
        sshagent(['green-ssh']) {
          sh """
            ssh -o StrictHostKeyChecking=no ubuntu@$GREEN_IP <<'EOS'
              export AWS_REGION='$AWS_REGION'
              export ECR_URI='$ECR_URI'
              aws ecr get-login-password --region \$AWS_REGION | \
                docker login --username AWS --password-stdin \$ECR_URI

              sed -i "s@image:.*@image: \$ECR_URI/$APP_NAME:$BUILD_TAG@" /opt/green/docker-compose.green.yml
              docker pull \$ECR_URI/$APP_NAME:$BUILD_TAG
              docker compose -f /opt/green/docker-compose.green.yml up -d
            EOS
          """
        }
      }
    }

    stage('Switch Traffic â†’ Green') {
      steps {
        sshagent(['lb-ssh']) {
          sh """
            ssh -o StrictHostKeyChecking=no ec2-user@$LB_IP <<'EOS'
              sudo sed -i 's/10\\.0\\.1\\.100/10.0.1.101/' /etc/nginx/conf.d/loadbalancer.conf
              sudo nginx -s reload
            EOS
          """
        }
      }
    }
  }

  post {
    success {
      echo "âœ… develop-be ë°°í¬ ì™„ë£Œ (Green)"
    }
    failure {
      echo "âŒ ì‹¤íŒ¨ - ì½˜ì†” ë¡œê·¸ í™•ì¸"
    }
  }
}

```

### **2.4 Docker í™˜ê²½ êµ¬ì„±**

\[BE\] Dockerfile
``` 
# ë‹¤ì¤‘ ì•„í‚¤í…ì²˜(amd64Â·arm64) ì§€ì› JRE 17
FROM eclipse-temurin:17-jre

# TimeZone ì„¤ì •
ENV TZ=Asia/Seoul

# JARë¥¼ ë„£ì„ ë””ë ‰í„°ë¦¬
WORKDIR /app

# ë¹Œë“œëœ JAR ë³µì‚¬ (ìœˆë„ìš°Â·ë¦¬ëˆ…ìŠ¤ ëª¨ë‘ ê²½ë¡œ êµ¬ë¶„ì / ê°€ëŠ¥)
COPY build/libs/*.jar app.jar
# ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì‹œ ì—´ í¬íŠ¸
EXPOSE 8080

# ìŠ¤í”„ë§ ë¶€íŠ¸ ì‹¤í–‰
ENTRYPOINT ["java","-jar","/app/app.jar"]

```

### **2.5 Nginx êµ¬ì„±**

EC2 Blue Nginx
```
events {
    worker_connections 1024;
}

http {
    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile            on;
    tcp_nopush          on;
    keepalive_timeout   65;
    types_hash_max_size 4096;

    include             /etc/nginx/mime.types;
    default_type        application/octet-stream;

    # Load modular configuration files from the /etc/nginx/conf.d directory.
    # See http://nginx.org/en/docs/ngx_core_module.html#include
    # for more information.
    include /etc/nginx/conf.d/*.conf;

    server {
        listen       80;
        listen       [::]:80;
        server_name  _;
        root         /usr/share/nginx/html;

        # Load configuration files for the default server block.
        include /etc/nginx/default.d/*.conf;

        error_page 404 /404.html;
        location = /404.html {
        }

        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
        }
    }

```

---

## **III. DB**

### **1\. ë¤í”„ íŒŒì¼ ì ìš© ë°©ë²•**
```bash
mysql -u S12P31A705@stg-yswa-kr-practice-db-master \
      -p \
      -h stg-yswa-kr-practice-db-master.mariadb.database.azure.com \
      S12P31A705 \
      < exec/db/dump.sql
```

* `dump.sql`ì€ `exec/db/dump.sql`ì— ìœ„ì¹˜

* ê°œë°œìš© ê¸°ë³¸ ë°ì´í„° í¬í•¨

---

## **IV. ì‹œì—° ì‹œë‚˜ë¦¬ì˜¤**

### **1\. ì „ì²´ íë¦„**

**1ë‹¨ê³„**: ì˜·ì¥ì— ì˜· ë“±ë¡ (êµ¬ë§¤ë‚´ì—­, ë¼ì´ë¸ŒëŸ¬ë¦¬, ì‚¬ì§„)

**2ë‹¨ê³„**: ì½”ë”” ìƒì„± / ì¶”ì²œ / ë³µì‚¬

**3ë‹¨ê³„**: ì¹œêµ¬ ìš”ì²­ / ì½”ë”” ìš”ì²­ / ê²ŒìŠ¤íŠ¸  

**4ë‹¨ê³„**: ì½”ë””ì— ëŒ“ê¸€

**5ë‹¨ê³„**: í”„ë¡œí•„ ìˆ˜ì •

### **2\. í™”ë©´ë³„ ê¸°ëŠ¥**

#### **1\. ì˜·ì¥ì— ì˜· ë“±ë¡**

1-1. êµ¬ë§¤ë‚´ì—­ ìŠ¤ìº” ë“±ë¡  
![êµ¬ë§¤ë‚´ì—­ìŠ¤ìº”](/uploads/e2ca151e2d929b8fcce98f4141c5edc3/êµ¬ë§¤ë‚´ì—­ìŠ¤ìº”.gif)

1-2. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ë¡ \- ì˜· ê²€ìƒ‰í•´ì„œ ë“±ë¡  
![ë¼ì´ë¸ŒëŸ¬ë¦¬ê²€ìƒ‰ì˜·ë“±ë¡](/uploads/b604a3bdfa1e060358afc0a0a4e57702/ë¼ì´ë¸ŒëŸ¬ë¦¬ê²€ìƒ‰ì˜·ë“±ë¡.gif)

1-3. ì‚¬ì§„ìœ¼ë¡œ ë“±ë¡  
![ì‚¬ì§„ìœ¼ë¡œì˜·ë“±ë¡](/uploads/609b08fc86d49ad48c39dcf3eb9d6528/ì‚¬ì§„ìœ¼ë¡œì˜·ë“±ë¡.gif)
#### **2\. ì½”ë”” ìƒì„±**

2-1. ë‚´ ì˜·ì¥ì˜ ì˜·ìœ¼ë¡œ ì½”ë”” ìƒì„±  
![ì½”ë””ë§Œë“¤ê¸°](/uploads/b81eee51811a88d15a9b1d5d35efee6d/ì½”ë””ë§Œë“¤ê¸°.gif)
#### **3\. ì¹œêµ¬ ìš”ì²­**

3-1 ì¹œêµ¬ ìš”ì²­ ë° ìˆ˜ë½  
![ì¹œêµ¬ìš”ì²­ë°ìˆ˜ë½](/uploads/8be5985d9f8e4e11207db8550388b41a/ì¹œêµ¬ìš”ì²­ë°ìˆ˜ë½.gif)

3-2. ì¹œêµ¬ì—ê²Œ ì½”ë”” ì¶”ì²œ  
![ì¹œêµ¬ì—ê²Œì½”ë””ì¶”ì²œ](/uploads/8f37af6bb63da210610c397ccb5a6fed/ì¹œêµ¬ì—ê²Œì½”ë””ì¶”ì²œ.gif)

3-2. ì™¸ë¶€ ë§í¬ë¡œ ì½”ë”” ìš”ì²­  
![ì™¸ë¶€ì¹œêµ¬ì—ê²Œ_ë§í¬](/uploads/821cdf5afaf13bead55ba54b4f6c9940/ì™¸ë¶€ì¹œêµ¬ì—ê²Œ_ë§í¬.gif)

3-3. ì¹œêµ¬ì˜ ì¶”ì²œì½”ë””ë¥¼ ë‚´ ì½”ë””ë¡œ ë³µì‚¬  
![ì½”ë””í¸ì…](/uploads/8ebadd2af7d154ebef81f8145cd37205/ì½”ë””í¸ì….gif)

#### **4\. ì½”ë”” ëŒ“ê¸€**
![ì½”ë””ëŒ“ê¸€](/uploads/b91b2514c71353f37f0ddf607df945d8/ì½”ë””ëŒ“ê¸€.gif)

#### **5\. ë§ˆì´í˜ì´ì§€**
![í”„ë¡œí•„ìˆ˜ì •](/uploads/c8202385decfa4515d2c192bee1c8151/í”„ë¡œí•„ìˆ˜ì •.gif)